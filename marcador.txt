javascript:(function(){
    alert('üõ°Ô∏è CENTINELA CU√ÅNTICO ACTIVO üõ°Ô∏è\n\nModo de monitoreo iniciado. Cada intento de comunicaci√≥n y cada evento de p√°gina ser√° registrado. Proceda con la operaci√≥n.');

    window.sovereignEvidence = {
        operation_start_timestamp: new Date().toISOString(),
        network_events: [],
        page_events: [],
        user_clicks: []
    };

    const originalFetch = window.fetch;
    window.fetch = function(...args) {
        const timestamp = new Date().toISOString();
        const requestInfo = {
            timestamp: timestamp,
            url: args[0] instanceof Request ? args[0].url : args[0],
            method: args[0] instanceof Request ? args[0].method : (args[1] ? args[1].method : 'GET')
        };
        window.sovereignEvidence.network_events.push({ type: 'fetch_initiated', request: requestInfo });
        console.log(`[CENTINELA] Fetch detectado: ${`requestInfo.method`} a ${`requestInfo.url`}`);
        const promise = originalFetch.apply(this, args);
        promise.then(res => {
            const resClone = res.clone();
            resClone.text().then(body => {
                 window.sovereignEvidence.network_events.push({ type: 'fetch_completed', url: res.url, status: res.status, response_body_preview: body.substring(0, 500) });
            });
        }).catch(err => {
            window.sovereignEvidence.network_events.push({ type: 'fetch_error', url: requestInfo.url, error: err.message });
        });
        return promise;
    };

    window.addEventListener('beforeunload', function(e) {
        console.log('[CENTINELA] Evento de recarga/cierre de p√°gina detectado.');
        window.sovereignEvidence.page_events.push({
            type: 'beforeunload',
            timestamp: new Date().toISOString(),
            message: 'El sistema intent√≥ refrescar o cerrar la p√°gina.'
        });
    });

    document.addEventListener('click', function(e) {
        const path = e.composedPath().map(el => el.tagName + (el.id ? '#'+el.id : '')).join(' > ');
        window.sovereignEvidence.user_clicks.push({
            type: 'click',
            timestamp: new Date().toISOString(),
            target_element_path: path
        });
        console.log(`[CENTINELA] Click detectado en: ${path}`);
    }, true);

    window.descargarEvidenciaFinal = function() {
        console.log('[CENTINELA] Preparando descarga de evidencia...');
        const blob = new Blob([JSON.stringify(window.sovereignEvidence, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'peritaje_cuantico_soberano.json';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        console.log('[CENTINELA] Archivo de evidencia ' + a.download + ' generado y descargado.');
    };
    
    console.log('[CENTINELA] Monitoreo de red y eventos activado. La funci√≥n "descargarEvidenciaFinal()" est√° disponible en la consola.');
})();
